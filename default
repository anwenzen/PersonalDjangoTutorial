# Nginx server configuration
# You need reload the nginx in your change this file every time
# nginx -s reload

server {
	# listen 80 default_server;
	# listen [::]:80 default_server;
	#
	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!

    listen         80;
    server_name    127.0.0.1;
    charset UTF-8;
    access_log      /var/log/nginx/web_access.log;
    error_log       /var/log/nginx/web_error.log;

    client_max_body_size 75M;

    location / {
        include uwsgi_params;                   # 通过uwsgi转发请求
        uwsgi_pass 127.0.0.1:8000;              # 和uwsgi.ini配置的socket端口保持一致, socket = :8000
        uwsgi_read_timeout 15;                  # 设置请求超时时间
    }

    location /downloading {                     # the downloads of my project
        expires 30d;
        autoindex on;
        add_header Cache-Control private;
        alias /var/website/downloads;
     }

    location /static {                          # 访问静态资源
        expires 30d;
        autoindex on;
        add_header Cache-Control private;
        alias /var/website/static;              # full path on you server，和setting.py配置的STATIC_ROOT路径保持一致
    }
 }